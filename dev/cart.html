<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>購物車</title>
    <link rel="stylesheet" href="./css/all.css">
    <link rel="stylesheet" href="./css/pages/cart.css">
    <!-- <link rel="stylesheet" href="./js/cart.js"> -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@9"></script>
    <!-- <link rel="stylesheet" href="./plugin/bootstrap-grid.css"> -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.css">
    <!-- <link rel="preconnect" href="https://fonts.gstatic.com"> -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@100;300;400;500;700;900&display=swap" rel="stylesheet">
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.6.12/vue.js"></script> -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/vuex/3.6.2/vuex.min.js"></script> -->
    <!-- <link rel="stylesheet" href="../css/indexFront.css"> -->
</head>

<body>
    <!-- 樣板 header   -->
    @@include('./layout/header.html')
    <!-- 會員登入 -->
    @@include('./layout/login.html')
    <!-- ------------------------------------------------------- -->
    <div class=" col-lg-6 d-flex justify-content-start progress__bar">
            <ul class="progress ">
              <li class="progress__item" :class=" { 'progress__item--active' : current_section>= 0}">1
                <p style="color:#FFD241;" class="progress__text">確認訂單</p>
              </li>
              <li class="progress progress_group_bar"  >
                <div class="progress-bar" role="progressbar" :class="{done:progress.payby}"  ></div>
              </li>
              <li class="progress__item " :class=" { 'progress__item--active' : current_section>= 1}">2
                <p class="progress__text ">填寫訂購資料</p>
              </li>
              <li class="progress progress_group_bar">
                <div class="progress-bar" role="progressbar" :class="{done:progress.payby}"></div>
              </li>
              <li class="progress__item " :class=" { 'progress__item--active' : current_section>= 2}">3
                <p class="progress__text ">完成訂單</p>
              </li>
            </ul>
    </div>
    <div class="title-block ">
        <h1 class="title">購物車</h1>
    </div>
    
        
    <div  class="Cart">
    <section class="section" id="new">
        <div class="content ">
            <div class="sub-title-block ">
                <h2 class="sub-title">確認訂單明細</h1>
                <div class="sub-title-line"></div>
            </div>
            <form id="app">
                <table class="table wrap">
                    <div  class="item_body space_box" style="padding: 20px; display: none;">
                        <p style="margin: 0 auto;">您還沒挑選任何商品，歡迎到商城逛逛唷！</p>
                    </div>
                    <div class="item_container listRow" v-for="(item, index) in itemList" :key="item.id" >
                        <div class=" item_body prodInfo">
                            <div class="item_detail">
                                <!-- <img v-bind:src="item.imgUrl" alt=""> -->
                                <div class="img prodPic"><img v-bind:src="item.imgUrl" alt="" style="max-width:100% "></div>
                                <!-- <div class="name">{{item.itemName}}</div> -->
                                <div class="prodName name"><span>品名:</span>{{item.itemName}}</div>
                                <div class="size prodSize"><span>尺寸:</span>{{item.size}}</div>
                            </div>

                            <!-- <div class="price"><span>$</span>{{item.price}}</div> -->
                            <div class="price itemcol prodPrice"><span>$</span>{{item.price}}</div>
                            <div class="count prodNumber" style="display: flex;">
                                <div class=" button round less " @click="lessCount(item)">-</div>
                                <span class="item-count">{{item.count}}</span>
                                <!-- {{item.count}} -->
                                <div class=" button round add " @click="addCount(item)">+</div>
                            </div>
                            <!-- <div class="amount">{{item.price * item.count}}</div> -->
                            <div class="amount itemcol">{{item.price * item.count}}</div>
                            <div class="operate itemcol">
                                <div class="round round-cxl add"  ><i class="fas fa-trash fa-1x" @click="del(index)"></i></div>
                            </div>
                        </div>
                  </div>
                  
                </table>
            
            <div class="total_body">
                <div class="total-title">
                    <h7 class="detail">結帳明細</h7>
                </div>
                <div class="row">
                    <span class="label">商品總金額:</span>
                    <div class="formw totalAmount">$<span id="subtotal">{{totalPrice}}</span></div>
                    <!-- <span class="formw"><input type="text" size="25" /></span> -->
                </div>
                <div class="row">
                    <span class="label">使用環保幣折扣:</span>
                    <div class="formw loginbutton"><button class="button">請登入會員</button></div>
                    <input class="formw discount" value="0"  >
                </div>
                
                
                <div class="orderCount">
                    
                    <!-- <p>總計：${{subtotal[index]}}</p> -->
                    <p class="orderCount-subtotal ">總計：<span id="allTotal">${{totalPrice}}</span></p>
                </div>

            </div>
            <div class="butSection">
                <button  class=" button button-buy more"><a style="color: white;" href='./Mall2.html'>繼續購物</a></button>
                <button onclick="location.href='./payment.html'" class="button button-pay thebill"><a style="color: #07082E;" href='./payment.html'>進行結帳</a></button>
                
            </div>
            
            </form>
        </div>
        


        </div>

    </section>
</div>

    <!-- 樣板 footer -->
    @@include('./layout/footer.html')

    <script src="./js/login.js"></script>
    <script src="./js/spacecar.js"></script>
    <script src="./js/vue.js"></script>
    <script>
        var app = new Vue({
    el:'#app',
    data:{
        products: [],
        itemList:[
          {
            id:'1',
            itemName:'優質短袖白T',
            imgUrl:'https://images.unsplash.com/photo-1534961880437-ce5ae2033053?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=668&q=80',
            size: 'XXL',
            price:'500',
            count:'1'
          },
          {
            id:'2',
            itemName:'骷髏手短黑T',
            imgUrl:'https://images.unsplash.com/photo-1503342217505-b0a15ec3261c?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1500&q=80',
            size: 'XXL',
            price:'790',
            count:'1'
          },
          {
            id:'3',
            itemName:'超時尚牛仔庫',
            imgUrl:'https://images.unsplash.com/photo-1529391409740-59f2cea08bc6?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1124&q=80',
            size: 'XXL',
            price:'120',
            count:'1'
          },
          {
            id:'4',
            itemName:'質感褐色系大衣服',
            imgUrl:'https://images.unsplash.com/photo-1491998664548-0063bef7856c?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1500&q=80',
            size: 'XXL',
            price:'230',
            count:'1'
          },
        ],
        
    
    },
    // itemList:[],
    methods:{
        addCount: function(item){
            item.count++;
        },
        lessCount: function(item){
            if(item.count>1){
            item.count--;                
            }
        
        },
        del: function(index){
            console.log(this);
            this.itemList.splice(index,1);
        },
        getId(index){
        sessionStorage.setItem("id", index+1);

}
    },
    computed:{
        totalPrice(){
            var total = 0; 
            for (var i = 0; i < this.itemList.length; i++) {
                var item = this.itemList[i]; 
                total += item.price * item.count; 
            } 
                // totalPrice+=total; 
            return total;
        },
    },
})


let storage = sessionStorage;
// function doFirst(){
// 	let itemString = storage.getItem('addItemList');   //A1001, A1005, A1006, A1002, 
//     let items = itemString.substr(0,itemString.length - 2).split(', ');
//     console.log(items);   //["A1001", "A1005", "A1006", "A1002"]
//     app.itemList = items;
// }

// addToStorage(total_price) {
//                 // storage['total'] += `${this.total_price} `;
//                 if (storage['total']) {
//                     // console.log('000');
//                     storage.setItem('total', `${this.total_price}`);
//                     // storage['total'] += `${this.total_price} `;
//                 } else {
//                     storage['total'] += `${this.total_price} `;
//                 }
//             },
function doFirst(){
    $('.discount').hide()
    $('.loginbutton').show()
     if(LogInMemId.textContent != ''){
        $('.discount').show()
        $('.loginbutton').hide()
    }else{
        $('.discount').hide()
        $('.loginbutton').show()
    }   

// window.addEventListener("load",showdiscount)
}

$(function(){
$(".loginbutton").on("click", function(){
$('#wholeScreenOverlay3').css('display','block');
});

});

window.addEventListener("load",doFirst)
</script>    
</body>

</html>
